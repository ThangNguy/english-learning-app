<div class="family-container">
  <h1 class="section-title">Family Members</h1>
  <p class="section-description">Manage your family learning group</p>
  
  <div class="action-bar">
    <button mat-raised-button color="primary" class="add-member-btn" (click)="openAddMemberDialog()">
      <mat-icon>person_add</mat-icon> Add Family Member
    </button>
    
    <mat-form-field appearance="outline" class="search-field">
      <mat-label>Search Members</mat-label>
      <input matInput [ngModel]="searchQuery()" (ngModelChange)="onSearchChange($event)" placeholder="Enter name...">
      <mat-icon matSuffix>search</mat-icon>
    </mat-form-field>
  </div>
  
  <div class="members-grid">
    <div *ngFor="let member of filteredMembers()" class="member-card">
      <div class="member-header" [style.backgroundColor]="member.color">
        <div class="member-avatar">
          <img *ngIf="member.avatarUrl" [src]="member.avatarUrl" [alt]="member.name">
          <mat-icon *ngIf="!member.avatarUrl" class="default-avatar">person</mat-icon>
        </div>
        <div class="member-actions">
          <button mat-icon-button [matMenuTriggerFor]="memberMenu" aria-label="Member actions">
            <mat-icon>more_vert</mat-icon>
          </button>
          <mat-menu #memberMenu="matMenu">
            <button mat-menu-item (click)="editMember(member)">
              <mat-icon>edit</mat-icon>
              <span>Edit</span>
            </button>
            <button mat-menu-item (click)="viewProgress(member)">
              <mat-icon>bar_chart</mat-icon>
              <span>View Progress</span>
            </button>
            <button mat-menu-item (click)="removeMember(member)">
              <mat-icon color="warn">delete</mat-icon>
              <span class="text-warn">Remove</span>
            </button>
          </mat-menu>
        </div>
      </div>
      
      <div class="member-content">
        <h2 class="member-name">{{ member.name }}</h2>
        <div class="member-info">
          <div class="info-item">
            <mat-icon>badge</mat-icon>
            <span>{{ member.role }}</span>
          </div>
          <div class="info-item" *ngIf="member.age">
            <mat-icon>cake</mat-icon>
            <span>{{ member.age }} years old</span>
          </div>
          <div class="info-item">
            <mat-icon>email</mat-icon>
            <span>{{ member.email }}</span>
          </div>
        </div>
        
        <div class="member-stats">
          <div class="progress-item">
            <span class="label">Learning Level</span>
            <div class="progress-bar-wrapper">
              <div class="progress-bar" [style.width]="(member.level / 10) * 100 + '%'" [style.backgroundColor]="member.color"></div>
            </div>
            <span class="value">Level {{ member.level }}</span>
          </div>
          
          <div class="stats-row">
            <div class="stat-box">
              <span class="stat-value">{{ member.points }}</span>
              <span class="stat-label">Points</span>
            </div>
            <div class="stat-box">
              <span class="stat-value">{{ member.completedTopics }}</span>
              <span class="stat-label">Topics</span>
            </div>
            <div class="stat-box">
              <span class="stat-value">{{ member.streak }}</span>
              <span class="stat-label">Day Streak</span>
            </div>
          </div>
        </div>
      </div>
      
      <div class="card-footer">
        <span class="last-active">Last active: {{ member.lastActive | date:'medium' }}</span>
        <button mat-stroked-button color="primary" class="send-reminder" (click)="sendReminder(member)">
          <mat-icon>notifications_active</mat-icon> Send Reminder
        </button>
      </div>
    </div>
  </div>
  
  <!-- Empty state when no members are found -->
  <div *ngIf="filteredMembers().length === 0" class="empty-state">
    <mat-icon class="empty-icon">group_off</mat-icon>
    <h2>No family members found</h2>
    <p *ngIf="searchQuery()">No members match your search "{{ searchQuery() }}"</p>
    <p *ngIf="!searchQuery()">Get started by adding family members to your account</p>
    <button mat-raised-button color="primary" (click)="openAddMemberDialog()">
      <mat-icon>person_add</mat-icon> Add Family Member
    </button>
  </div>
</div>
